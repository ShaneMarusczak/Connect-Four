"use strict";(()=>{let playerIsRed=!0,isPlayersTurn=!1,gameOver=!1,gameStarted=!1,playerNumber;const alreadyChecked=[],rows=6,cols=7,gameBoard=[],gameBoardContainer=document.getElementById("gameboard"),floatingCircles=document.getElementById("floatingCircles"),cellSize=120,winCheckLength=3,sleep=ms=>new Promise(resolve=>setTimeout(resolve,ms)),alertModalControl=(message,duration)=>{document.getElementById("alertshader").style.display="block",document.getElementById("alertmessage").innerText=message,sleep(duration).then(()=>{document.getElementById("alertshader").style.display="none"})},isAlreadyChecked=arr=>{for(const checked of alreadyChecked){let counter=0;for(const ar of arr)if(checked.includes(ar)&&counter++,counter===arr.length)return!0}return!1},inARowCheck=(inARow,attackMode)=>{let counter=0,inARowPieces=[];for(let i=0;i<6;i++)for(let j=0;j<7;j++){for(let k=1;k<inARow+1;k++)counter=i<6&&j+k<7&&gameBoard[i][j]==gameBoard[i][j+k]&&gameBoard[i][j]>0?counter+1:counter;if(counter===inARow){for(let k=0;k<inARow+1;k++)inARowPieces.push([i,j+k]);if(!attackMode)return inARowPieces;if(attackMode&&!isAlreadyChecked(inARowPieces))return inARowPieces;inARowPieces=[]}counter=0}for(let i=0;i<6;i++)for(let j=0;j<7;j++){for(let k=1;k<inARow+1;k++)counter=i+k<6&&j<7&&gameBoard[i][j]==gameBoard[i+k][j]&&gameBoard[i][j]>0?counter+1:counter;if(counter===inARow){for(let k=0;k<inARow+1;k++)inARowPieces.push([i+k,j]);if(!attackMode)return inARowPieces;if(attackMode&&!isAlreadyChecked(inARowPieces))return inARowPieces;inARowPieces=[]}counter=0}for(let i=0;i<6;i++)for(let j=0;j<7;j++){for(let k=1;k<inARow+1;k++)counter=i+k<6&&j+k<7&&gameBoard[i][j]==gameBoard[i+k][j+k]&&gameBoard[i][j]>0?counter+1:counter;if(counter===inARow){for(let k=0;k<inARow+1;k++)inARowPieces.push([i+k,j+k]);if(!attackMode)return inARowPieces;if(attackMode&&!isAlreadyChecked(inARowPieces))return inARowPieces;inARowPieces=[]}counter=0}for(let i=0;i<6;i++)for(let j=inARow;j<7;j++){for(let k=1;k<inARow+1;k++)counter=i+k<6&&j-k>=0&&gameBoard[i][j]==gameBoard[i+k][j-k]&&gameBoard[i][j]>0?counter+1:counter;if(counter===inARow){for(let k=0;k<inARow+1;k++)inARowPieces.push([i+k,j-k]);if(!attackMode)return inARowPieces;if(attackMode&&!isAlreadyChecked(inARowPieces))return inARowPieces;inARowPieces=[]}counter=0}return inARowPieces},animateDrop=({inputRow:inputRow,inputCol:inputCol,moveTurn:moveTurn,currentRow:currentRow=0}={})=>{currentRow!==inputRow&&(document.getElementById("d"+currentRow+inputCol).classList.add(moveTurn?"redPlaced":"yellowPlaced"),sleep(120).then(()=>{document.getElementById("d"+currentRow+inputCol).classList.remove(moveTurn?"redPlaced":"yellowPlaced")}),sleep(125).then(()=>{animateDrop({currentRow:currentRow+1,inputCol:inputCol,inputRow:inputRow,moveTurn:moveTurn})}))},winnersHighlight=(color,winners)=>{for(const winner of winners)document.getElementById("d"+winner[0]+winner[1]).classList.add(color)},playerMove=e=>{if(!gameOver&&gameStarted&&isPlayersTurn){document.getElementById("uiblocker").style.display="block";var col=Number(e.currentTarget.id.substring(2));let startingRow;for(let i=5;i>-1;i--)if(0===gameBoard[i][col]){animateDrop({inputCol:col,inputRow:i,moveTurn:playerIsRed}),document.getElementById("d"+i+col).classList.remove(playerIsRed?"redHighlight":"yellowHighLight"),gameBoard[i][col]=playerIsRed?1:2,startingRow=i;break}sleep(125*startingRow).then(()=>{document.getElementById("d"+startingRow+col).classList.add(playerIsRed?"redPlaced":"yellowPlaced"),sleep(150).then(()=>{const possibleWinners=inARowCheck(3,!1);4===possibleWinners.length?(winnersHighlight(playerIsRed?"redHighlight":"yellowHighLight",possibleWinners),gameOver=!0,alertModalControl("Player Wins!",2e3),document.getElementById("uiblocker").style.display="none"):sleep(200).then(()=>compMove())})})}},highLightMove=e=>{if(!gameOver&&gameStarted&&isPlayersTurn){var col=Number(e.currentTarget.id.substring(2));for(let i=5;i>-1;i--)if(0===gameBoard[i][col]){document.getElementById("d"+i+col).classList.add(playerIsRed?"redHighlight":"yellowHighLight"),document.getElementById("fc"+col).classList.add(playerIsRed?"redBounce":"yellowBounce"),document.getElementById("fc"+col).classList.add("gbounce");break}}},highLightMoveReset=e=>{if(!gameOver&&gameStarted&&isPlayersTurn){var col=Number(e.currentTarget.id.substring(2));document.getElementById("fc"+col).classList.remove(playerIsRed?"redBounce":"yellowBounce"),document.getElementById("fc"+col).classList.remove("gbounce");for(let i=5;i>-1;i--)if(0===gameBoard[i][col]){document.getElementById("d"+i+col).classList.remove(playerIsRed?"redHighlight":"yellowHighLight");break}}},randomIntFromInterval=(min,max)=>Math.floor(Math.random()*(max-min+1)+min),colForComp=()=>{const twoInARow=inARowCheck(1,!0),foundTwo=2===twoInARow.length&&gameBoard[twoInARow[0][0]][twoInARow[0][1]]===playerNumber,threeInARow=inARowCheck(2,!0),foundThree=3===threeInARow.length;if(foundThree&&threeInARow[0][1]===threeInARow[1][1]&&0===gameBoard[threeInARow[0][0]-1][threeInARow[0][1]])return alreadyChecked.push(threeInARow),threeInARow[0][1];if(foundThree&&threeInARow[0][0]===threeInARow[2][0]){if(threeInARow[2][1]+1<6&&0===gameBoard[threeInARow[2][0]][threeInARow[2][1]+1])return alreadyChecked.push(threeInARow),threeInARow[2][1]+1;if(threeInARow[0][1]-1>=0&&0===gameBoard[threeInARow[0][0]][threeInARow[0][1]-1])return alreadyChecked.push(threeInARow),threeInARow[0][1]-1}if(foundTwo&&twoInARow[0][1]===twoInARow[1][1]&&0===gameBoard[twoInARow[0][0]-1][twoInARow[0][1]])return alreadyChecked.push(twoInARow),twoInARow[0][1];if(foundTwo&&twoInARow[0][0]===twoInARow[1][0]){if(twoInARow[1][1]+1<6&&0===gameBoard[twoInARow[1][0]][twoInARow[1][1]+1])return alreadyChecked.push(twoInARow),twoInARow[1][1]+1;if(twoInARow[0][1]-1>=0&&0===gameBoard[twoInARow[0][0]][twoInARow[0][1]-1])return alreadyChecked.push(twoInARow),twoInARow[0][1]-1}return randomIntFromInterval(0,6)},compMove=()=>{document.getElementById("uiblocker").style.display="block";const col=colForComp();for(let i=5;i>-1;i--)if(0===gameBoard[i][col])return animateDrop({inputCol:col,inputRow:i,moveTurn:!playerIsRed}),gameBoard[i][col]=playerIsRed?2:1,void compStepTwo(i,col);compMove()},compStepTwo=(row,col)=>{sleep(125*row).then(()=>{document.getElementById("d"+row+col).classList.add(playerIsRed?"yellowPlaced":"redPlaced"),sleep(150).then(()=>{const possibleWinners=inARowCheck(3,!1);if(document.getElementById("uiblocker").style.display="none",4===possibleWinners.length)return winnersHighlight(playerIsRed?"yellowHighLight":"redHighlight",possibleWinners),gameOver=!0,void alertModalControl("Computer Wins!",2e3)})}),isPlayersTurn=!0},redChosen=()=>{gameStarted=!0,playerIsRed=!0,isPlayersTurn=!0,playerNumber=1,document.getElementById("selectYellow").style.display="none",document.getElementById("selectRed").removeEventListener("click",redChosen),document.getElementById("selectRed").classList.remove("pointerCursor")},yellowChosen=()=>{document.getElementById("uiblocker").style.display="block",document.getElementById("selectRed").style.display="none",document.getElementById("selectYellow").removeEventListener("click",yellowChosen),document.getElementById("selectYellow").classList.remove("pointerCursor"),gameStarted=!0,playerIsRed=!1,playerNumber=2,sleep(400).then(()=>compMove())};(()=>{document.getElementById("strtOvrBtn").addEventListener("click",()=>location.reload()),document.getElementById("selectRed").addEventListener("click",redChosen),document.getElementById("selectYellow").addEventListener("click",yellowChosen);for(let i=0;i<7;i++){const circle=document.createElement("div");circle.id="fc"+i,circle.classList.add("floatingCircle"),floatingCircles.appendChild(circle);for(let j=0;j<6;j++){const cell=document.createElement("div");gameBoardContainer.appendChild(cell),cell.id="c"+j+i;const topPosition=120*j+5,leftPosition=120*i+5;cell.style.top=topPosition+"px",cell.style.left=leftPosition+"px";const circleDiv=document.createElement("div");circleDiv.classList.add("circleDiv"),cell.classList.add("squareDiv"),cell.appendChild(circleDiv),cell.addEventListener("mouseover",highLightMove),cell.addEventListener("mouseleave",highLightMoveReset),cell.addEventListener("click",playerMove),circleDiv.id="d"+j+i}}for(let i=0;i<6;i++){gameBoard.push([]);for(let j=0;j<7;j++)gameBoard[i].push(0)}})()})();